# Kurasel ğŸ¡

**æš®ã‚‰ã—ã¨ç²¾ç®— (Living & Settlement)**

**Kurasel** ã¯ã€ãµãŸã‚Šã®æš®ã‚‰ã—ã¨ãŠé‡‘ã‚’æ•´ãˆã‚‹ã€ã‚·ãƒ³ãƒ—ãƒ«ã§ãƒ¢ãƒ€ãƒ³ãªç²¾ç®—ã‚¢ãƒ—ãƒªã§ã™ã€‚
ãƒ¬ã‚·ãƒ¼ãƒˆã‚’æ’®ã‚‹ã ã‘ã§AIãŒè‡ªå‹•å…¥åŠ›ã€‚é¢å€’ãªè¨ˆç®—ã¯ã‚¢ãƒ—ãƒªã«ä»»ã›ã¦ã€æ”¯æ‰•ã„ã‚„å—ã‘å–ã‚Šã®ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚‚ã²ã¨ç›®ã§ç®¡ç†ã€‚ã€ŒãŠé‡‘ã®ã‚„ã‚Šå–ã‚Šã€ã‚’äº‹å‹™ä½œæ¥­ã‹ã‚‰ã€Œå¿ƒåœ°ã‚ˆã„ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã€ã¸å¤‰ãˆã¾ã™ã€‚

<img src="/public/icon-512.png" alt="Kurasel App Icon" width="120" style="border-radius: 24px;">

## âœ¨ ç‰¹å¾´ (Features)

* **ğŸ¤– AIãƒ¬ã‚·ãƒ¼ãƒˆã‚¹ã‚­ãƒ£ãƒ³**
    * Google Gemini 1.5 Flash ã‚’æ´»ç”¨ã€‚ã‚«ãƒ¡ãƒ©ã§ãƒ¬ã‚·ãƒ¼ãƒˆã‚’æ’®ã‚‹ã ã‘ã§ã€Œåº—åãƒ»é‡‘é¡ãƒ»æ—¥ä»˜ãƒ»ã‚«ãƒ†ã‚´ãƒªã€ã‚’AIãŒå³åº§ã«è‡ªå‹•å…¥åŠ›ã—ã¾ã™ã€‚
* **âœ… ç²¾ç®—ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ç®¡ç†**
    * æœˆã”ã¨ã«ã€Œæ”¯æ‰•ã„å®Œäº†ã€ã€Œå—ã‘å–ã‚Šå®Œäº†ã€ã®ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚’ç®¡ç†ã€‚èª¤æ“ä½œé˜²æ­¢ã®ç¢ºèªæ©Ÿèƒ½ä»˜ãã§ã€æ‰•ã„å¿˜ã‚Œã‚„äºŒé‡æ‰•ã„ã‚’é˜²ãã¾ã™ã€‚
* **âœ¨ ã‚¹ãƒãƒ¼ãƒˆç²¾ç®—**
    * é€šå¸¸ã®å‰²ã‚Šå‹˜ã«åŠ ãˆã€ã€Œã‚¹ã‚­ãƒ£ãƒ³æ‰‹å½“ï¼ˆå…¥åŠ›ã—ã¦ãã‚ŒãŸäººã¸ã®æ„Ÿè¬ä»£ï¼‰ã€ã‚„ã€Œç«¯æ•°èª¿æ•´ï¼ˆ100å††å˜ä½ï¼‰ã€ã‚’è‡ªå‹•è¨ˆç®—ã™ã‚‹ã‚¹ãƒãƒ¼ãƒˆãƒ¢ãƒ¼ãƒ‰ã‚’æ­è¼‰ã€‚
* **â˜ï¸ ãƒ¬ã‚·ãƒ¼ãƒˆã‚¯ãƒ©ã‚¦ãƒ‰ä¿å­˜**
    * ã‚¹ã‚­ãƒ£ãƒ³ã—ãŸãƒ¬ã‚·ãƒ¼ãƒˆç”»åƒã¯ã‚¯ãƒ©ã‚¦ãƒ‰ï¼ˆSupabase Storageï¼‰ã«è‡ªå‹•ä¿å­˜ã€‚ã„ã¤ã§ã‚‚è¦‹è¿”ã›ã¾ã™ã€‚
* **ğŸ’¬ è±Šã‹ãªã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³**
    * å±¥æ­´ã”ã¨ã«ã‚³ãƒ¡ãƒ³ãƒˆã‚„ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ä»˜ããƒªã‚¢ã‚¯ã‚·ãƒ§ãƒ³ï¼ˆâ¤ï¸, ğŸ‘, ğŸ‰, ğŸ™ï¼‰ã‚’é€ã‚Œã€ä¼šè©±ãŒç”Ÿã¾ã‚Œã¾ã™ã€‚
* **ğŸ“± PWAå¯¾å¿œ**
    * ãƒ›ãƒ¼ãƒ ç”»é¢ã«è¿½åŠ ã™ã‚‹ã“ã¨ã§ã€ãƒã‚¤ãƒ†ã‚£ãƒ–ã‚¢ãƒ—ãƒªã®ã‚ˆã†ãªæ»‘ã‚‰ã‹ãªæ“ä½œæ„Ÿã‚’å®Ÿç¾ã€‚
* **ğŸ¨ æ´—ç·´ã•ã‚ŒãŸUI**
    * ã‚¹ãƒ¬ãƒ¼ãƒˆã‚°ãƒ¬ãƒ¼ã¨ãƒ›ãƒ¯ã‚¤ãƒˆã‚’åŸºèª¿ã¨ã—ãŸã€æ¸…æ½”æ„Ÿã®ã‚ã‚‹ã‚°ãƒ©ã‚¹ãƒ¢ãƒ¼ãƒ•ã‚£ã‚ºãƒ ãƒ‡ã‚¶ã‚¤ãƒ³ã€‚

## ğŸ› ï¸ æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯ (Tech Stack)

* **Framework:** Next.js 14 (App Router)
* **Language:** TypeScript
* **Styling:** Tailwind CSS
* **Database & Storage:** Supabase (PostgreSQL)
* **AI:** Google Generative AI SDK (Gemini 1.5 Flash)
* **Icons:** Lucide React
* **Deployment:** Netlify / Vercel

## ğŸš€ ãƒ­ãƒ¼ã‚«ãƒ«ã§ã®å®Ÿè¡Œæ–¹æ³• (Setup)

1.  **ãƒªãƒã‚¸ãƒˆãƒªã®ã‚¯ãƒ­ãƒ¼ãƒ³**
    ```bash
    git clone [https://github.com/KouSei089/kurasel.git](https://github.com/KouSei089/kurasel.git)
    cd kurasel
    ```

2.  **ä¾å­˜é–¢ä¿‚ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«**
    ```bash
    npm install
    ```

3.  **ç’°å¢ƒå¤‰æ•°ã®è¨­å®š**
    `.env.local` ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã€ä»¥ä¸‹ã®ã‚­ãƒ¼ã‚’è¨­å®šã—ã¦ãã ã•ã„ã€‚
    ```env
    NEXT_PUBLIC_SUPABASE_URL=your_supabase_url
    NEXT_PUBLIC_SUPABASE_ANON_KEY=your_supabase_anon_key
    NEXT_PUBLIC_GOOGLE_API_KEY=your_gemini_api_key
    ```

4.  **é–‹ç™ºã‚µãƒ¼ãƒãƒ¼ã®èµ·å‹•**
    ```bash
    npm run dev
    ```
    http://localhost:3000 ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦ç¢ºèªã§ãã¾ã™ã€‚

## ğŸ“‚ ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨­å®š (Supabase SQL)

ã‚¢ãƒ—ãƒªã®å‹•ä½œã«å¿…è¦ãªãƒ†ãƒ¼ãƒ–ãƒ«å®šç¾©ã§ã™ã€‚Supabaseã®SQLã‚¨ãƒ‡ã‚£ã‚¿ã§å®Ÿè¡Œã—ã¦ãã ã•ã„ã€‚

### 1. æ”¯å‡ºè¨˜éŒ²ãƒ†ãƒ¼ãƒ–ãƒ« (`expenses`)
```sql
create table expenses (
  id bigint generated by default as identity primary key,
  created_at timestamp with time zone default timezone('utc'::text, now()) not null,
  store_name text,
  amount integer,
  purchase_date date,
  paid_by text,
  category text,
  reactions jsonb default '{}'::jsonb,
  comments jsonb default '[]'::jsonb,
  receipt_url text -- ãƒ¬ã‚·ãƒ¼ãƒˆç”»åƒã®URL
);
```

### 2. æœˆæ¬¡ç²¾ç®—ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒ†ãƒ¼ãƒ–ãƒ« (monthly_settlements)
```sql

create table monthly_settlements (
  month text primary key, -- 'YYYY-MM' å½¢å¼
  is_paid boolean default false,     -- æ”¯æ‰•ã£ãŸã‹
  is_received boolean default false, -- å—ã‘å–ã£ãŸã‹ï¼ˆç²¾ç®—å®Œäº†ï¼‰
  updated_at timestamp with time zone default timezone('utc'::text, now())
);
```

### 3. Storageè¨­å®š
Supabaseã®Storageãƒ¡ãƒ‹ãƒ¥ãƒ¼ã§ receipts ã¨ã„ã†åå‰ã®Public Bucketã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚

## ğŸ—ï¸ ã‚·ã‚¹ãƒ†ãƒ æ§‹æˆå›³ (Architecture)

```mermaid
graph TD
    User((User))
    subgraph "Frontend (PWA)"
        UI[Next.js App Router]
        Logic[Business Logic]
    end
    
    subgraph "AI Service"
        Gemini[Google Gemini 1.5 Flash]
    end
    
    subgraph "Backend (Supabase)"
        DB[(PostgreSQL)]
        Storage[Storage Bucket]
    end

    User -->|ğŸ“¸ Take Photo| UI
    UI -->|ğŸ–¼ï¸ Image Data| Gemini
    Gemini -->|ğŸ“ JSON Extraction| Logic
    Logic -->|ğŸ’¾ Insert Data| DB
    Logic -->|â˜ï¸ Upload Image| Storage
    DB -->|ğŸ“Š Fetch History| UI
```

### 2. ERå›³ (Entity Relationship Diagram)

ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®è¨­è¨ˆå›³ã§ã™ã€‚`expenses`ï¼ˆæ”¯å‡ºï¼‰ã¨ `monthly_settlements`ï¼ˆç²¾ç®—ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ï¼‰ã®é–¢ä¿‚ãªã©ã‚’å®šç¾©ã—ã¾ã™ã€‚

```mermaid
erDiagram
    USERS {
        int id PK
        string name "User Name"
    }
    
    EXPENSES {
        bigint id PK
        date purchase_date
        text store_name
        integer amount
        text category "food, daily, etc"
        text paid_by "User Name"
        text receipt_url
        jsonb reactions
        jsonb comments
        timestamp created_at
    }

    MONTHLY_SETTLEMENTS {
        text month PK "YYYY-MM"
        boolean is_paid
        boolean is_received
        timestamp updated_at
    }

    USERS ||--o{ EXPENSES : "creates"
    EXPENSES }|..|{ MONTHLY_SETTLEMENTS : "belongs to month"
```
